steps:
  VW_BALANCE_SHEET_OPENBALANCE_PVT-35279c8a-5c83-41da-99e6-e22ed2ca166a:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: FINANCIAL_DATA_MODEL
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b831ac39-5ef7-40c8-b897-9ce63dbdc758
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(6)
            defaultValue: ""
            description: ""
            name: Database ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 99c6261b-c475-4a80-bf22-1f8e7051a509
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(45)
            defaultValue: ""
            description: ""
            name: Account Number
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5f2924c1-3331-414c-99fa-6cc1507d5f22
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(4)
            defaultValue: ""
            description: ""
            name: Fiscal Year
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cb646bc7-452a-43dd-9ee3-a3adf4cfd130
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(6)
            defaultValue: ""
            description: ""
            name: AUDTORG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - columnReference:
              columnCounter: 35fcbb9a-c651-4d86-a629-843b3edbeb6f
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SOURCE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ebc12d8a-6b53-4a2c-b818-d3eb89def2d4
                    stepCounter: 60575ce5-d395-4889-95fc-dd8963ddd1d6
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 258a02c2-4d0d-40b8-9684-910e0126d7c6
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: Fiscal Period
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5d274e81-3ffe-4de1-9058-155eb43909f0
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: Fiscal Month
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5efdbc5b-5132-4c21-90b7-54e7cb26c4d3
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 0c995794-a662-4e5f-8f14-d521ae38fd70
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: PERIODENDDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 142ca2dc-5645-4e55-82cc-70bb29a9943e
              stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
            config: {}
            dataType: NUMBER(19,3)
            defaultValue: ""
            description: ""
            name: PERIODBALANCE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                	CREATE OR REPLACE VIEW {{ ref('FINANCIAL_DATA_MODEL', 'VW_BALANCE_SHEET_OPENBALANCE_PVT')}} AS (
                SELECT 
                AUDTORG AS "Database ID",
                ACCTID AS "Account Number",
                FSCSYR as "Fiscal Year",
                AUDTORG,
                SOURCE,
                CASE "Fiscal Month"
                    WHEN 'OPENBAL' THEN '00'
                    WHEN 'NETPERD1' THEN '1'
                    WHEN 'NETPERD2' THEN '2'
                    WHEN 'NETPERD3' THEN '3'
                    WHEN 'NETPERD4' THEN '4'
                    WHEN 'NETPERD5' THEN '5'
                    WHEN 'NETPERD6' THEN '6'
                    WHEN 'NETPERD7' THEN '7'
                    WHEN 'NETPERD8' THEN '8'
                    WHEN 'NETPERD9' THEN '9'
                    WHEN 'NETPERD10' THEN '10'
                    WHEN 'NETPERD11' THEN '11'
                    WHEN 'NETPERD12' THEN '12'
                    WHEN 'NETPERD13' THEN '13'
                    WHEN 'NETPERD14' THEN '14'
                ELSE NULL
                END AS "Fiscal Period",
                CASE "Fiscal Month"
                    WHEN 'OPENBAL' THEN 'OPENBALANCE'
                    WHEN 'NETPERD1' THEN 'JANUARY'
                    WHEN 'NETPERD2' THEN 'FEBRUARY'
                    WHEN 'NETPERD3' THEN 'MARCH'
                    WHEN 'NETPERD4' THEN 'ARPIL'
                    WHEN 'NETPERD5' THEN 'MAY'
                    WHEN 'NETPERD6' THEN 'JUNE'
                    WHEN 'NETPERD7' THEN 'JULY'
                    WHEN 'NETPERD8' THEN 'AUGUST'
                    WHEN 'NETPERD9' THEN 'SEPTEMBER'
                    WHEN 'NETPERD10' THEN 'OCTOBER'
                    WHEN 'NETPERD11' THEN 'NOVEMBER'
                    WHEN 'NETPERD12' THEN 'DECEMBER'
                    WHEN 'NETPERD13' THEN 'PERIOD13'
                    WHEN 'NETPERD14' THEN 'PERIOD14'
                ELSE NULL
                END AS "Fiscal Month",
                CAST(
                CASE 
                WHEN "Fiscal Period" NOT IN (00, 13, 14) THEN CONCAT("Fiscal Year", '-',"Fiscal Period", '-','01')
                    ELSE '1901-01-01' END AS DATE) AS DATE,
                LAST_DAY(DATE) AS PERIODENDDATE,
                PERIODBALANCE
                FROM 
                 {{ ref('SAGE_COMBINED', 'GLAFS_COMBINED') }}
                    UNPIVOT (PERIODBALANCE FOR "Fiscal Month" IN (
                OPENBAL,
                NETPERD1 ,
                NETPERD2 ,
                NETPERD3,
                NETPERD4 ,
                NETPERD5 ,
                NETPERD6 ,
                NETPERD7 ,
                NETPERD8 ,
                NETPERD9 ,
                NETPERD10 ,
                NETPERD11 ,
                NETPERD12 ,
                NETPERD13,
                NETPERD14
                )) 
                ORDER BY "Fiscal Period" asc
                    )
            dependencies:
              - locationName: SAGE_COMBINED
                nodeName: GLAFS_COMBINED
            join:
              joinCondition: FROM {{ ref('SAGE_COMBINED', 'GLAFS_COMBINED') }} "GLAFS_COMBINED"
            name: VW_BALANCE_SHEET_OPENBALANCE_PVT
            noLinkRefs: []
      name: VW_BALANCE_SHEET_OPENBALANCE_PVT
      overrideSQL: true
      schema: ""
      sqlType: View
      type: sql
    stepCounter: 35279c8a-5c83-41da-99e6-e22ed2ca166a
