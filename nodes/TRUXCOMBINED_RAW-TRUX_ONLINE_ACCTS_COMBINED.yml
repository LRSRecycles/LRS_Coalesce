fileVersion: 1
id: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
name: TRUX_ONLINE_ACCTS_COMBINED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: true
  locationName: TRUXCOMBINED_RAW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41536117-9dff-4452-ab6c-55a5163c7c91
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Account Unique Identifier
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f5d2375-3597-41fa-aa27-6532f50c3e10
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: 9e16d400-df4d-40d5-9e08-3d490f4cdf45
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe56c4a-a64e-48ca-a9c5-538ba14ae884
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: Email Address for Online Payment Website
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a280ebad-1956-4f88-880b-17a651d82414
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: 39f3aaa6-7b67-41ef-8852-4e01a2160a7e
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69c07ac5-ee7b-4db7-859d-2f8796a5f13b
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: Registration Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c0ff170-a187-459e-bd3c-e414a2af3265
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: c27772cd-baa9-4b5f-863f-6cd49a558c11
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3be2e06-15e2-4592-893c-348d59f6c49b
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Access Unique Identifier
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae9b34af-6622-45cc-a8a1-fe35e07d99bf
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: a4ee08be-feee-4293-ab33-0144d4056412
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af8de0fc-4e84-46a8-9b5b-49c4c27663ab
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: Company Code
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f4c59c-78f3-402c-915e-a3d510cab9ac
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: e63b0d1e-f237-4f4a-bc23-01392561da84
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbdbbc39-32a8-4fd4-8fdb-3401095e0284
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Customer Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a4e816d-6acf-495b-8bf2-8ce8089c601a
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: ef5ff2e0-e269-48ba-a3f8-dce8ff0f03e0
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b8b201a-f044-4ac6-842d-3b15c2eea14b
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Site Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c746ced-c577-4ef6-b023-108d3a89e234
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: 53721f6c-f067-4bf3-ba59-39a3ab4a7e60
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32cabce0-920d-48f6-b252-a57d274fc9ea
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: Activation Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 586a0440-051a-4883-8184-520cf48d9361
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: be11e5a6-dc04-4231-ba01-d71db76750c9
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05a1ec57-7a52-4226-8e38-aba22d77ab4e
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: Date Deactivated
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 211c7e25-8645-4ebb-829a-544b7d2f6ca1
                stepCounter: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
            transform: ""
          - columnReferences:
              - columnCounter: a184cb2f-c6b4-4910-8cfb-330435a92dd7
                stepCounter: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e2798969-b09e-458c-902e-8a2a92de4f2f
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'TRUX_'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_COMP\"||'_COMP_RAW'"
          - columnReferences: []
            transform: "'TRUX_'||UPPER(\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_COMP\")||'_COMP_RAW'"
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d394ccde-61e5-49c2-a250-fb11364f85bf
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'TRUX_'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_COMP\"||'_COMP_RAW-'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_CUST\""
          - columnReferences: []
            transform: "'TRUX_'||UPPER(\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_COMP\")||'_COMP_RAW-'||\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_CUST\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ddaca7c6-5bed-4bbc-866c-65d6488c6ec6
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer_Site
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'TRUX_'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_COMP\"||'_COMP_RAW-'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_CUST\"||'-'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_SITE\""
          - columnReferences: []
            transform: "'TRUX_'||UPPER(\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_COMP\")||'_COMP_RAW-'||\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_CUST\"||'-'||\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_SITE\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b02cf37d-177d-4e16-8c6c-ecafe844c0ad
          stepCounter: dddbc35e-07ad-4a38-8688-bf30fa1d5a2b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer_Site_Bill_To
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'TRUX_'||UPPER(\"LEGACY_ONLINE_ACCT\".\"OPACCESS_COMP\")||'_COMP_RAW-'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_CUST\"||'-'||\"LEGACY_ONLINE_ACCT\".\"OPACCESS_SITE\"||'-'||\"CM03_COMBINED\".\"CM03_BILLTO\""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'TRUX_'||UPPER(\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_COMP\")||'_COMP_RAW-'||\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_CUST\"||'-'||\"MIDWEST_ONLINE_ACCT\".\"OPACCESS_SITE\"||'-'||\"CM03_COMBINED\".\"CM03_BILLTO\""
        systemColumnType: None
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CM03_COMBINED: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
          LEGACY_ONLINE_ACCT: fb59c4ea-af97-447b-bc96-5b91e4c5dac6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: MASTER_DATA
            nodeName: LEGACY_ONLINE_ACCT
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM03_COMBINED
        join:
          joinCondition: |2-
             FROM {{ ref('MASTER_DATA', 'LEGACY_ONLINE_ACCT') }} "LEGACY_ONLINE_ACCT"
            INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM03_COMBINED') }} "CM03_COMBINED"
               ON "LEGACY_ONLINE_ACCT"."OPACCESS_CUST" = "CM03_COMBINED"."CM03_CUST"
              AND 'TRUX_'||"LEGACY_ONLINE_ACCT"."OPACCESS_COMP"||'_COMP_RAW' = "CM03_COMBINED"."SOURCE"
        name: TRUX_ONLINE_ACCTS_COMBINED
        noLinkRefs: []
      - aliases:
          CM03_COMBINED: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
          MIDWEST_ONLINE_ACCT: 3d92e0c4-1198-4705-847d-b9e3b5e2478a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: MASTER_DATA
            nodeName: MIDWEST_ONLINE_ACCT
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM03_COMBINED
        join:
          joinCondition: |2-
             FROM {{ ref('MASTER_DATA', 'MIDWEST_ONLINE_ACCT') }} "MIDWEST_ONLINE_ACCT"
            INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM03_COMBINED') }} "CM03_COMBINED"
               ON "MIDWEST_ONLINE_ACCT"."OPACCESS_CUST" = "CM03_COMBINED"."CM03_CUST"
              AND 'TRUX_'||"MIDWEST_ONLINE_ACCT"."OPACCESS_COMP"||'_COMP_RAW' = "CM03_COMBINED"."SOURCE"
              
        name: MIDWEST_ONLINE_ACCT
        noLinkRefs: []
  name: TRUX_ONLINE_ACCTS_COMBINED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
