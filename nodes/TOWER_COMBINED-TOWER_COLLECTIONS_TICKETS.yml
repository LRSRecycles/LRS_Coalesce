fileVersion: 1
id: 647cca31-8098-4bfa-ae39-e4fb762820be
name: TOWER_COLLECTIONS_TICKETS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TOWER_COMBINED
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 226c584b-9455-446b-a434-74b3caa17817
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: TRIPUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78adfb4c-9018-418a-9aad-71ad5832e25e
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76ff839f-05ba-44c0-8634-95cbd7b2bedf
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: TRIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03192ac4-7a6a-472b-a25f-5f87669b76b8
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e53e09d-7b63-4b38-bed3-4fb9b88b7876
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: ROUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9a8e55f-1c2b-4505-8317-a8fdfe93abdd
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0873f968-577d-497d-a871-19b440d8a7ef
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: VEHICLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607afa49-7952-4a82-a233-e6c570eb42e9
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024b9b5d-9d2f-43b7-b31b-0c4fb87e40e2
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: DRIVER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e29550c6-72a1-4466-91ea-cf533bfecade
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c396e6-81c3-4653-8d6a-bf0ecaebbb3d
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: HELPER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2f86286-05c9-40c8-b882-13709297dffb
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e6954f5-81f5-4eca-b587-c2b60ad5d7b0
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: TRIPSTARTTIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f154a42-2264-4876-961e-16b2ffe58be2
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b1347a8-411a-4e6a-af60-1fe3754e268d
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: TRIPENDTIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee4816fd-20bb-4af0-a961-69221afb9dfa
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cad482fd-f60f-4e08-bcd3-02788958f77f
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eed9bed0-05cb-4213-86c3-10d5fde0a686
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25b5944d-5802-40bb-b3a3-3889d161c728
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: DESTINATIONARRIVETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 686b89f6-4f11-46fc-9f0e-e20e3adddd31
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96559e9e-4f58-4b80-9f14-0138b981e997
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: DESTINATIONLEAVETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a9ec759-9da7-4460-89d0-256a6e761a15
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c18eb1e-c17b-4c48-ba23-5a11af94ac1c
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: SCALETICKETNBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 428e38f5-3cae-40cd-8be3-bfe54f778381
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0b588ed-2396-454d-a2c4-227589986404
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        hashDetails: null
        name: EXTRACHARGES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71d5c15b-52fc-465f-b1ef-3b636483b531
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a477044d-99c6-446b-993c-3ca242953ea0
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: WORKORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0ccaf6-438e-4d5c-b7cb-776512f61c80
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec07424b-2f0d-4581-930b-8913143bf713
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: DISPOSALDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50158067-c0b9-4766-88e6-0e42a74da0e9
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ec42538-add3-4af9-8398-b1b2aaae6f50
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: TRIPTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ead7497-3b02-446c-9ceb-7d645fef9d59
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7415aad6-82d5-42d6-9ee8-61336662d7c2
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: SYNCROWVERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89979122-9414-4474-ad9e-5372bc03d329
                stepCounter: 4a7229a0-96c1-434e-829b-391d2ca4d556
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05477bc0-745e-4356-af22-2dff0ccf359a
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: TRIPMATERIALUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7518ba98-2bfa-48ba-90f8-4cd85b7a7663
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab35f030-a754-4ff6-af36-c186cb35649e
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: WEIGHTUOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1033710-9e3e-42f4-8079-3613ecb8771f
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbcbce8c-2212-4ba4-b508-b9564d738535
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: VOLUMEUOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad94e6d5-9328-4518-9696-418609a55cef
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: "'CUBICYARDS'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 638abc24-e373-4323-887e-555309a2875b
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a08477f-e53d-4bf3-beda-16dd57896b2a
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe835411-be00-4da8-95bd-64d44f6d93cc
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: NUMBER(38,6)
        description: ""
        name: WEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c83e5976-0023-4d71-84b0-bcab9cc1c9d8
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00256159-af8f-413d-affc-32c604f6d608
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: NUMBER(38,6)
        description: Manual conversion of volume to yards
        name: VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40b7bbf8-b35e-4b45-8061-b53a53fd6ff9
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: |-
              CASE WHEN "TRIPMATERIAL_COMBINED"."VOLUMEUOM" = 'GALLON'
              THEN "TRIPMATERIAL_COMBINED"."VOLUME"*0.00495113
              WHEN "TRIPMATERIAL_COMBINED"."VOLUMEUOM" = 'TON'
              THEN "TRIPMATERIAL_COMBINED"."VOLUME"/1.4
              ELSE "TRIPMATERIAL_COMBINED"."VOLUME"
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 112abc38-4198-4f61-91d8-44dce067a74f
          stepCounter: 647cca31-8098-4bfa-ae39-e4fb762820be
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        name: FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a77bd546-66ea-42df-8ea0-6718e91c67b8
                stepCounter: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          TRIPMATERIAL_COMBINED: a8ad10b9-cd8f-4dba-ab4b-1bfe6df54e19
          TRIP_COMBINED: 4a7229a0-96c1-434e-829b-391d2ca4d556
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TOWER_COMBINED
            nodeName: TRIP_COMBINED
          - locationName: TOWER_COMBINED
            nodeName: TRIPMATERIAL_COMBINED
        join:
          joinCondition: |-
            FROM {{ ref('TOWER_COMBINED', 'TRIP_COMBINED') }} "TRIP_COMBINED"
            LEFT JOIN {{ ref('TOWER_COMBINED', 'TRIPMATERIAL_COMBINED') }} "TRIPMATERIAL_COMBINED"
            ON "TRIP_COMBINED"."TRIPUID" = "TRIPMATERIAL_COMBINED"."TRIPUID"
        name: TOWER_COLLECTIONS_TICKETS
        noLinkRefs: []
  name: TOWER_COLLECTIONS_TICKETS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
