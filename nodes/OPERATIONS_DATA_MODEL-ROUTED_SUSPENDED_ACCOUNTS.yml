steps:
  ROUTED_SUSPENDED_ACCOUNTS-c2283f66-c735-42f9-bbdb-2b098b177084:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: OPERATIONS_DATA_MODEL
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: bed17a9b-8537-4526-ae08-5dc7df43eaee
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER
            description: ""
            name: DIM_RM02_COMBINED_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e95a09a8-f23e-4380-a804-cfbed6b3696f
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: 5213cea6-6a6f-4b66-8084-7e4150b11856
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(38,0)
            description: ""
            name: Unique Identifier
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4a101287-6ea9-4cc2-9c17-ec19f0dd558d
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: 69cb2c11-d550-488f-a463-6a2856f43470
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Route Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b37d047f-2628-439b-b16e-d81adac7714e
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: 79fed829-ef11-4ab0-a855-199965d20a95
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(18,2)
            description: ""
            name: Sequence\Call Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1f1b8018-f512-4066-bb6e-f2c7dc4d7f5d
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: c0841a62-9878-4d12-a0d2-77f6f0c53c87
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(38,0)
            description: ""
            name: Customer Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b9447b2a-a89f-40f4-bb98-19aa17053268
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: cd6d9773-49db-453e-a517-c6983a21c279
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(38,0)
            description: ""
            name: Site Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c35d61e3-73ee-4aaf-ad05-a30e3571e54c
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: 3ccbda28-4779-4c3e-8b31-dab3a61d71b1
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(38,0)
            description: ""
            name: Service Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f054b4a4-cc4f-412e-84a5-95aba8966630
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: f4457ad6-e839-4aa9-af5d-57ce29a489fa
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR(2)
            description: ""
            name: Activity Code
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7419755e-955e-4d9d-b629-46cf6197fff1
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: d404f8fa-5361-48e6-a179-35bc37cd3840
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: NUMBER(18,2)
            description: ""
            name: Number of Lifts
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10f10613-e433-41bb-ad5f-3729f36dc903
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: b6d1bf6a-0bde-45fd-bf17-5423948ac7e7
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ddbfdd5d-f863-4323-aa04-16ddb0e9f880
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: d29d8504-a805-4e11-bc89-625b81b3c5af
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source_Route_Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4acfb903-307b-410f-bf56-6b7c1fc235a8
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b9238e11-a541-4fda-9d91-0ccd228bcbb4
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source_Stop_UID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 96fa8224-9605-451c-956f-111060877bbe
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ff2bde40-dcd6-44cd-89ee-b78eea278ca8
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source_Customer
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9aed6cf6-19b6-48fc-9d58-93ee99485de8
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: da5a81dc-a5c0-4d1d-90dd-cfcbf023e584
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source_Customer_Site
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 09046f80-a98b-4268-99bf-48fa18c20469
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
          - columnReference:
              columnCounter: 9801e070-25f0-46ef-a629-0c6beaede846
              stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
            dataType: VARCHAR
            description: ""
            name: Source_Customer_Site_Service
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a6179b51-be0a-4150-a2e1-1077ef66a454
                    stepCounter: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CUSTOMER_MASTER: becf5d54-6c39-4fc7-9462-7c72760dddd6
              CUSTOMER_SITE_MASTER: 56ae5e3c-c6cd-4eb5-a3ae-25d02a9ab031
              CUSTOMER_SITE_SERVICE_MASTER: cd02e258-8f28-4971-8f0b-ba70c7e2d8c4
              ROUTE_STOP_MASTER: 86a02c21-13cb-4ad0-b45b-4a6612cd0305
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: MASTER_DATA_CLEAN
                nodeName: CUSTOMER_MASTER
              - locationName: MASTER_DATA_CLEAN
                nodeName: CUSTOMER_SITE_MASTER
              - locationName: MASTER_DATA_CLEAN
                nodeName: CUSTOMER_SITE_SERVICE_MASTER
              - locationName: MASTER_DATA_CLEAN
                nodeName: ROUTE_STOP_MASTER
            join:
              joinCondition: |2
                 FROM {{ ref('MASTER_DATA_CLEAN', 'ROUTE_STOP_MASTER') }} "ROUTE_STOP_MASTER"
                INNER JOIN {{ ref('MASTER_DATA_CLEAN', 'CUSTOMER_SITE_SERVICE_MASTER') }} "CUSTOMER_SITE_SERVICE_MASTER"
                   ON "ROUTE_STOP_MASTER"."Customer Number" = "CUSTOMER_SITE_SERVICE_MASTER"."Customer Number"
                  AND "ROUTE_STOP_MASTER"."Site Number" = "CUSTOMER_SITE_SERVICE_MASTER"."Site Number"
                  AND "ROUTE_STOP_MASTER"."Service Number" = "CUSTOMER_SITE_SERVICE_MASTER"."Service Number"
                  AND "ROUTE_STOP_MASTER"."Source" = "CUSTOMER_SITE_SERVICE_MASTER"."Source"
                
                INNER JOIN {{ ref('MASTER_DATA_CLEAN', 'CUSTOMER_SITE_MASTER') }} "CUSTOMER_SITE_MASTER"
                   ON "ROUTE_STOP_MASTER"."Customer Number" = "CUSTOMER_SITE_MASTER"."Customer Number"
                  AND "ROUTE_STOP_MASTER"."Site Number" = "CUSTOMER_SITE_MASTER"."Site Number"
                  AND "ROUTE_STOP_MASTER"."Source" = "CUSTOMER_SITE_MASTER"."Source"
                
                INNER JOIN {{ ref('MASTER_DATA_CLEAN', 'CUSTOMER_MASTER') }} "CUSTOMER_MASTER"
                   ON "ROUTE_STOP_MASTER"."Customer Number" = "CUSTOMER_MASTER"."Customer Number"
                  AND "ROUTE_STOP_MASTER"."Source" = "CUSTOMER_MASTER"."Source"
                
                WHERE "ROUTE_STOP_MASTER"."SYSTEM_CURRENT_FLAG" = 'Y'
                  AND "CUSTOMER_SITE_SERVICE_MASTER"."SYSTEM_CURRENT_FLAG" = 'Y'
                  AND "CUSTOMER_SITE_MASTER"."SYSTEM_CURRENT_FLAG" = 'Y'
                  AND "CUSTOMER_MASTER"."SYSTEM_CURRENT_FLAG" = 'Y'
                  AND ("CUSTOMER_MASTER"."Suspend Reason" IS NOT NULL OR "CUSTOMER_SITE_MASTER"."Suspend Reason" IS NOT NULL)
                  AND "ROUTE_STOP_MASTER"."Source" NOT LIKE '%TOWER%'
            name: ROUTED_SUSPENDED_ACCOUNTS
            noLinkRefs: []
      name: ROUTED_SUSPENDED_ACCOUNTS
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: c2283f66-c735-42f9-bbdb-2b098b177084
