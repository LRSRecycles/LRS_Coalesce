steps:
  ROUTED_SUSPENDED_ACCOUNTS-1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896:
    operation:
      config:
        postSQL: ""
        preSQL: ""
        testsEnabled: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: true
      locationName: OPERATIONS_DATA_MODEL
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6c27d2d7-5314-4f2b-9ae4-7a628dedffac
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            isSurrogateKey: true
            name: ROUTED_SUSPENDED_ACCOUNTS_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 869c785f-ace8-4ea7-a2ec-e76b1b230d56
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: NUMBER(38,0)
            description: ""
            isBusinessKey: true
            name: Customer Number
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f4f0ee58-acb8-4fac-aecb-08df89feda55
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: 73066796-bdd0-4d2e-9731-5689e42e40fa
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 63033ec1-70b9-4036-a063-dc8b8dfbbd3f
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            isBusinessKey: true
            keyColumnType: None
            name: Site Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "0"
              - columnReferences:
                  - columnCounter: 112edb7e-c114-4829-bb58-6e8264e56247
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
            systemColumnType: None
          - columnReference:
              columnCounter: b093f882-bed6-4213-a197-e4d84937d872
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: VARCHAR(80)
            description: ""
            name: Customer Name
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3a89ab31-7625-4b35-a03c-d5dac82ec0de
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: 71f2b13a-b8ca-41f4-88e2-d0e2bacb512a
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - columnReference:
              columnCounter: e9d05cca-4805-428f-b369-311cce78a54e
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: VARCHAR(80)
            description: ""
            name: Address
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ed153fe-140a-46cd-93f6-23b20903fa8f
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: TRIM(REPLACE("CM03_COMBINED"."CM03_ADD1" || ' ' || IFNULL("CM03_COMBINED"."CM03_ADD2", ''), '  ', ' '))
              - columnReferences:
                  - columnCounter: f3cbbef7-3765-4395-9444-43af56c96472
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: TRIM(REPLACE("CM04_COMBINED"."CM04_ADD2" || ' ' || IFNULL("CM04_COMBINED"."CM04_ADD3", ''), '  ', ' '))
          - columnReference:
              columnCounter: 4322ed94-9cdf-4f13-a5f4-8ebd225ea487
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: NUMBER(38,0)
            description: ""
            name: Sales Representative Code
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: IFNULL("CD07_COMBINED"."CD07_CODE",-1)
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: IFNULL("CD07_COMBINED"."CD07_CODE",-1)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cc1ac3d9-b60a-47e3-bdd2-cddc7fc00532
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Sales Representative
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: IFNULL("CD07_COMBINED"."CD07_DESC",'No Sales Rep')
              - columnReferences: []
                transform: IFNULL("CD07_COMBINED"."CD07_DESC",'No Sales Rep')
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cde9f86d-0c6d-45b7-99ac-b43e915e5b68
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Date ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: TO_VARCHAR("CM03_COMBINED"."CM03_SUSDATE"::DATE, 'yyyymmdd')
              - columnReferences: []
                transform: TO_VARCHAR("CM04_COMBINED"."CM04_SUSDATE"::DATE, 'yyyymmdd')
            systemColumnType: None
          - columnReference:
              columnCounter: ee7d6e4d-2ceb-4d69-b5bb-b5e46af58e63
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: Suspend Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 691ce933-2665-497e-8b93-b0bfbcbf9f00
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: 2cc34c66-a262-4584-9f34-13909203e630
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - columnReference:
              columnCounter: 1d32e82f-782c-4d6b-bde6-2e2e0cda12e5
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: VARCHAR(2)
            description: ""
            name: Suspend Reason Code
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 103edbbd-b26d-4372-a06a-6679ae4aa378
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: b6aaac48-d781-43c7-9f10-b6e115c1a505
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 449ec2c8-887c-4fae-b948-b21d95a246e0
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Suspend Reason Desc
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e99d9bcb-a280-43c1-be6d-b11489821019
                    stepCounter: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
                transform: ""
              - columnReferences:
                  - columnCounter: e99d9bcb-a280-43c1-be6d-b11489821019
                    stepCounter: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
                transform: ""
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6ec04d84-ddca-4f5b-8830-3a6786e85821
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Suspended Customer/Site
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "'Suspended Customer'"
              - columnReferences: []
                transform: "'Suspended Site'"
            systemColumnType: None
          - columnReference:
              columnCounter: cd144a88-10c2-430a-8ca2-c43a7b43de99
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            name: Reinstate Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 04542fd0-4989-4e59-88b4-7199136e9dc4
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: b282f768-205d-4569-96e4-6af1885bc8d0
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6f28fc17-1094-4756-b9f6-15db09db2623
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(3)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Route
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 2, 3)
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 2, 3)
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f020f50a-34ea-499a-b488-23a1dbdb8f68
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            isBusinessKey: true
            keyColumnType: None
            name: Route Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9b1128ac-317c-43b9-ba51-d078224f328f
                    stepCounter: 214d43c4-9a9c-4c4e-bd79-79c1687f3204
                transform: ""
              - columnReferences:
                  - columnCounter: 9b1128ac-317c-43b9-ba51-d078224f328f
                    stepCounter: 214d43c4-9a9c-4c4e-bd79-79c1687f3204
                transform: ""
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 926cd708-dd32-4eba-a1d1-c5ca56851821
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Route Description
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d7c79737-6613-483a-b1b2-02babcee34d3
                    stepCounter: bd25ccfd-afa5-4e34-be04-467c3e0970fd
                transform: ""
              - columnReferences:
                  - columnCounter: d7c79737-6613-483a-b1b2-02babcee34d3
                    stepCounter: bd25ccfd-afa5-4e34-be04-467c3e0970fd
                transform: ""
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4d4ca8ce-fb7e-4d18-bdb1-4408ea8a6e2c
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(100)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Route Name
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: TRIM("RM01_COMBINED"."RM01_NUMB" || ' - ' || IFNULL("RM01_COMBINED"."RM01_DESC", ''))
              - columnReferences: []
                transform: TRIM("RM01_COMBINED"."RM01_NUMB" || ' - ' || IFNULL("RM01_COMBINED"."RM01_DESC", ''))
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 200a4808-d3fa-4d6d-9969-11927f07c22e
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Route Day Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1)
              - columnReferences: []
                transform: SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1)
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f3309bac-f6b9-4552-98c7-c18dc3fda39c
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Route Day Name
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: |-
                  CASE
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 1 THEN 'Monday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 2 THEN 'Tuesday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 3 THEN 'Wednesday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 4 THEN 'Thursday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 5 THEN 'Friday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 6 THEN 'Saturday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 7 THEN 'Sunday'
                    ELSE NULL
                  END
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: |-
                  CASE
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 1 THEN 'Monday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 2 THEN 'Tuesday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 3 THEN 'Wednesday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 4 THEN 'Thursday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 5 THEN 'Friday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 6 THEN 'Saturday'
                    WHEN SUBSTRING(TO_VARCHAR("RM02_COMBINED"."RM02_NUMB"), 1, 1) = 7 THEN 'Sunday'
                    ELSE NULL
                  END
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5365963c-ca9d-4b44-91e0-c41158610960
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Start Location ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 68f411b9-2ab6-44b8-94eb-9b1578d8c48e
                    stepCounter: bd25ccfd-afa5-4e34-be04-467c3e0970fd
                transform: IFNULL("SL01_COMBINED"."SL01_ID", -1)
              - columnReferences:
                  - columnCounter: 68f411b9-2ab6-44b8-94eb-9b1578d8c48e
                    stepCounter: bd25ccfd-afa5-4e34-be04-467c3e0970fd
                transform: IFNULL("SL01_COMBINED"."SL01_ID", -1)
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4d11edd1-5749-4a64-97c2-d9b15924409b
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Start Location Name
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 909dd0ca-34ac-428f-80e9-005e7d4805c0
                    stepCounter: 6a58c60a-fd40-458e-b415-7aa216626cb2
                transform: IFNULL("SL01_COMBINED"."SL01_NAME", 'Add Start Location in TRUX')
              - columnReferences:
                  - columnCounter: 909dd0ca-34ac-428f-80e9-005e7d4805c0
                    stepCounter: 6a58c60a-fd40-458e-b415-7aa216626cb2
                transform: IFNULL("SL01_COMBINED"."SL01_NAME", 'Add Start Location in TRUX')
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f2fd83f0-06d2-4a04-8790-139ec2f02fe7
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: TRUX or Tower
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "'TRUX'"
              - columnReferences: []
                transform: "'TRUX'"
            systemColumnType: None
          - columnReference:
              columnCounter: 6af158d9-d25c-43fa-91d9-7f7aa5051da0
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            dataType: VARCHAR
            description: ""
            isBusinessKey: true
            name: Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 59d6cbae-d8d4-4c16-8e69-85895469efa8
                    stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
                transform: ""
              - columnReferences:
                  - columnCounter: d294b557-2e1e-4121-a36c-9e1e63cd8fa1
                    stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 07e6d7c7-4400-4c82-8a37-a8d9ff4750df
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(100)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Source Name
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e965ad54-1824-4ecd-8536-79d0b14d88f2
                    stepCounter: c2e3b305-d522-488b-bbc6-6ade93cd3385
                transform: ""
              - columnReferences:
                  - columnCounter: e965ad54-1824-4ecd-8536-79d0b14d88f2
                    stepCounter: c2e3b305-d522-488b-bbc6-6ade93cd3385
                transform: ""
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4a1a087c-f249-4120-a92c-6dad51b5e0f3
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR(80)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Source_Customer_Site
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"CM03_COMBINED\".\"SOURCE\"||'-'||\"CM03_COMBINED\".\"CM03_CUST\"||'-0'"
              - columnReferences: []
                transform: "\"CM04_COMBINED\".\"SOURCE\"||'-'||\"CM04_COMBINED\".\"CM04_CUST\"||'-'||\"CM04_COMBINED\".\"CM04_SITE\""
            systemColumnType: None
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5df1fc2c-f794-4c4a-a882-07e377b875d3
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            isSystemVersion: true
            name: SYSTEM_VERSION
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fae576dd-8c07-450c-b961-cd83d1ae946f
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            isSystemCurrentFlag: true
            name: SYSTEM_CURRENT_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
              - columnReferences: []
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3a8602eb-e3a5-4ee4-baae-eede498fd5b6
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemStartDate: true
            name: SYSTEM_START_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 122c121a-dfcd-4935-abb4-7fc1a3a10beb
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemEndDate: true
            name: SYSTEM_END_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST('2999-12-31 00:00:00' AS TIMESTAMP)
              - columnReferences: []
                transform: CAST('2999-12-31 00:00:00' AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e4e7a0b3-d6ac-4a87-abbc-689ac2e11c24
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemCreateDate: true
            name: SYSTEM_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 02c2ed5a-2a19-4aff-b8e8-2c8284b15b0f
              stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
            config: {}
            dataType: TIMESTAMP
            defaultValue: ""
            description: ""
            isSystemUpdateDate: true
            name: SYSTEM_UPDATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
              - columnReferences: []
                transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CD03_COMBINED: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
              CD07_COMBINED: bd4674f7-935e-485f-8433-a9a843dde723
              CM03_COMBINED: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
              RM01_COMBINED: bd25ccfd-afa5-4e34-be04-467c3e0970fd
              RM02_COMBINED: 214d43c4-9a9c-4c4e-bd79-79c1687f3204
              SL01_COMBINED: 6a58c60a-fd40-458e-b415-7aa216626cb2
              TRUX_DATABASE_METADATA: c2e3b305-d522-488b-bbc6-6ade93cd3385
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: MASTER_DATA_CLEAN
                nodeName: TRUX_DATABASE_METADATA
              - locationName: TRUXCOMBINED_RAW
                nodeName: CD03_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: CD07_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: CM03_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: RM01_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: RM02_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: SL01_COMBINED
            join:
              joinCondition: |2-
                 FROM {{ ref('TRUXCOMBINED_RAW', 'CM03_COMBINED') }} "CM03_COMBINED"
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD07_COMBINED') }} "CD07_COMBINED"
                   ON "CM03_COMBINED"."CM03_SREP" = "CD07_COMBINED"."CD07_CODE"
                  AND "CM03_COMBINED"."SOURCE" = "CD07_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD03_COMBINED') }} "CD03_COMBINED"
                   ON "CM03_COMBINED"."CM03_SUSREA" = "CD03_COMBINED"."CD03_CODE"
                  AND "CM03_COMBINED"."SOURCE" = "CD03_COMBINED"."SOURCE"
                
                INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'RM02_COMBINED') }} "RM02_COMBINED"
                   ON "CM03_COMBINED"."CM03_CUST" = "RM02_COMBINED"."RM02_CUST"
                  AND "CM03_COMBINED"."SOURCE" = "RM02_COMBINED"."SOURCE"
                
                INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'RM01_COMBINED') }} "RM01_COMBINED"
                   ON "RM02_COMBINED"."RM02_NUMB" = "RM01_COMBINED"."RM01_NUMB"
                  AND "RM02_COMBINED"."SOURCE" = "RM01_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'SL01_COMBINED') }} "SL01_COMBINED"
                   ON "RM01_COMBINED"."RM01_SLID" = "SL01_COMBINED"."SL01_ID"
                  AND "RM01_COMBINED"."SOURCE" = "SL01_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('MASTER_DATA_CLEAN', 'TRUX_DATABASE_METADATA') }} "TRUX_DATABASE_METADATA"
                   ON "CM03_COMBINED"."SOURCE" = "TRUX_DATABASE_METADATA"."SNOWFLAKE_NAME"
                
                WHERE "CM03_COMBINED"."CM03_SUSDATE" IS NOT NULL
                  AND "CM03_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "CD07_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "CD03_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "RM02_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "RM01_COMBINED"."_FIVETRAN_DELETED" = FALSE
            name: TRUX_SUSPENDED_CUSTOMERS
            noLinkRefs: []
          - aliases:
              CD03_COMBINED: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
              CD07_COMBINED: bd4674f7-935e-485f-8433-a9a843dde723
              CM03_COMBINED: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
              CM04_COMBINED: f47180be-fdce-4312-84ff-04027f8092c0
              RM01_COMBINED: bd25ccfd-afa5-4e34-be04-467c3e0970fd
              RM02_COMBINED: 214d43c4-9a9c-4c4e-bd79-79c1687f3204
              SL01_COMBINED: 6a58c60a-fd40-458e-b415-7aa216626cb2
              TRUX_DATABASE_METADATA: c2e3b305-d522-488b-bbc6-6ade93cd3385
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: MASTER_DATA_CLEAN
                nodeName: TRUX_DATABASE_METADATA
              - locationName: TRUXCOMBINED_RAW
                nodeName: CD03_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: CD07_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: CM03_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: CM04_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: RM01_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: RM02_COMBINED
              - locationName: TRUXCOMBINED_RAW
                nodeName: SL01_COMBINED
            join:
              joinCondition: |2-
                 FROM {{ ref('TRUXCOMBINED_RAW', 'CM03_COMBINED') }} "CM03_COMBINED"
                INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM04_COMBINED') }} "CM04_COMBINED"
                   ON "CM03_COMBINED"."CM03_CUST" = "CM04_COMBINED"."CM04_CUST"
                  AND "CM03_COMBINED"."SOURCE" = "CM04_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD07_COMBINED') }} "CD07_COMBINED"
                   ON "CM04_COMBINED"."CM04_SREP" = "CD07_COMBINED"."CD07_CODE"
                  AND "CM04_COMBINED"."SOURCE" = "CD07_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD03_COMBINED') }} "CD03_COMBINED"
                   ON "CM04_COMBINED"."CM04_SUSREA" = "CD03_COMBINED"."CD03_CODE"
                  AND "CM04_COMBINED"."SOURCE" = "CD03_COMBINED"."SOURCE"
                
                INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'RM02_COMBINED') }} "RM02_COMBINED"
                   ON "CM04_COMBINED"."CM04_CUST" = "RM02_COMBINED"."RM02_CUST"
                  AND "CM04_COMBINED"."CM04_SITE" = "RM02_COMBINED"."RM02_SITE"
                  AND "CM04_COMBINED"."SOURCE" = "RM02_COMBINED"."SOURCE"
                
                INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'RM01_COMBINED') }} "RM01_COMBINED"
                   ON "RM02_COMBINED"."RM02_NUMB" = "RM01_COMBINED"."RM01_NUMB"
                  AND "RM02_COMBINED"."SOURCE" = "RM01_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'SL01_COMBINED') }} "SL01_COMBINED"
                   ON "RM01_COMBINED"."RM01_SLID" = "SL01_COMBINED"."SL01_ID"
                  AND "RM01_COMBINED"."SOURCE" = "SL01_COMBINED"."SOURCE"
                
                 LEFT OUTER JOIN {{ ref('MASTER_DATA_CLEAN', 'TRUX_DATABASE_METADATA') }} "TRUX_DATABASE_METADATA"
                   ON "CM04_COMBINED"."SOURCE" = "TRUX_DATABASE_METADATA"."SNOWFLAKE_NAME"
                
                WHERE "CM04_COMBINED"."CM04_SUSDATE" IS NOT NULL
                  AND "CM03_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "CM04_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "CD07_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "CD03_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "RM02_COMBINED"."_FIVETRAN_DELETED" = FALSE
                  AND "RM01_COMBINED"."_FIVETRAN_DELETED" = FALSE
            name: TRUX_SUSPENDED_SITES
            noLinkRefs: []
      name: ROUTED_SUSPENDED_ACCOUNTS
      overrideSQL: false
      schema: ""
      sqlType: Dimension
      type: sql
    stepCounter: 1b577bd4-1f9e-4e4e-acb8-bf43cb1c9896
