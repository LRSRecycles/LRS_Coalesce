fileVersion: 1
id: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
name: STG_DM01_COMBINED_FILTERED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TRUXCOMBINED_RAW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e6f17ff-142a-479c-99d9-ad232b04f4c4
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR
        description: ""
        name: Unique Identifier
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5423fef-7aee-4bf3-9b57-2e7e806b9a22
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c86b54e6-8a55-42ba-806a-4454eb77a8e6
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR
        description: ""
        name: Customer Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09351083-f732-4f8a-801a-a2bc4f64bda7
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b67b013-f561-4afc-8ef6-9698803cd88e
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR
        description: ""
        name: Site Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b326805-baf1-47c8-9ed1-58caf894f91d
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bfc23d2-9d0b-4404-a014-d3fffdc7b9d6
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(26)
        description: ""
        name: Invoice Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f78d0f7c-d4e1-474e-bff4-a887072d5695
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bf4fbcb-a091-42a3-b5c8-09bf630c5371
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: Invoice Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2971ee2-7bad-4ec7-aa04-519131f4de3f
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc38f07d-e2a7-4cb2-aef3-f651127a0ed6
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Service Site Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47b57f03-83ea-4b58-be06-777f1eb2b720
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50275912-6db7-4691-b5b2-34ee703acc17
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: Payable Flag
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eedd8b64-4814-4ae9-b115-5d579cf591f7
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32b27ed8-69e0-40c8-9e59-9e28ce29a27e
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(14)
        description: ""
        name: Bill Tickets Individually
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64cfc819-8893-426d-b762-c6826ca03fc1
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6e8691-633e-4f9e-a2dd-2ff4bfd50ead
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Contract
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e4f7363-619c-43cd-aaf0-653081d96e81
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aa3faf2-1775-463e-b15d-6a02a35bed8b
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: Invoice Amount
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b7bb00d-8441-4567-bcd9-6aa73adb48dd
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce93ed60-b506-46cb-8c6c-07f2cf7d4393
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Credit Memo Link to Original Invoice Record
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c1c7b63-38e7-4986-93f0-c714b15a10ce
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 351c84f2-c929-45b8-aae4-791ec2a51391
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(4)
        description: ""
        name: Disposal Facility
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e8688c6-83eb-484b-bdf2-a02e45924caf
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e755c7b2-a4d6-4269-af4c-b337243021f9
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR
        description: ""
        name: Source
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ceee4ba-fa87-4c5e-a8c0-fbad648ced91
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b1865554-066d-4d76-9c2c-fc7a5eaebe7b
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"DM01_COMBINED\".\"SOURCE\"||'-'||\"DM01_COMBINED\".\"DM01_CUST\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 320deadc-57d2-4c6c-b9b3-9a7b7187883a
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Billing_Source_Customer_Site
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"DM01_COMBINED\".\"SOURCE\"||'-'||\"DM01_COMBINED\".\"DM01_CUST\"||'-'||\"DM01_COMBINED\".\"DM01_SITE\""
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a39d02d2-1c2b-4db9-a948-16acc108ddea
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: BOOLEAN
        description: ""
        name: _FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a5fb891-117a-4e22-910e-5c71979b13bf
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ee8eed6-933f-4042-9429-9b1fcfe866a1
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e85ab3fc-5aad-49a2-af9d-8ca2ae5f2bab
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7f5bb79-9a33-4069-a3cb-37395ee93709
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: NUMBER
        description: ""
        name: Sort
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c628f9d2-77ba-477f-8369-571eecac097b
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c497b7d-dcb0-4311-8d07-0cc27528e68d
          stepCounter: b553d0dd-cbb8-443a-8025-cf4e8416eb1e
        config: {}
        dataType: VARCHAR
        description: ""
        name: METADATA$ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f39a8b3-b424-44f6-902f-802379f20343
                stepCounter: 8e473efe-2de8-4255-bf7b-195f76a0318b
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DM01_COMBINED: 8e473efe-2de8-4255-bf7b-195f76a0318b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TRUXCOMBINED_RAW
            nodeName: DM01_COMBINED
        join:
          joinCondition: |2-
             FROM {{ ref('TRUXCOMBINED_RAW', 'DM01_COMBINED') }} "DM01_COMBINED"
            WHERE "DM01_COMBINED"."_FIVETRAN_DELETED" = FALSE
              AND "DM01_COMBINED"."Sort" = 1
              AND "DM01_COMBINED"."METADATA$ACTION" = 'INSERT'
        name: STG_DM01_COMBINED_FILTERED
        noLinkRefs: []
  name: STG_DM01_COMBINED_FILTERED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
