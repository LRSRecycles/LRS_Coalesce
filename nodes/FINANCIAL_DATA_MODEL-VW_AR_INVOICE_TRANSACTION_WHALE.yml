fileVersion: 1
id: 2a079e46-0222-4f53-be62-f75daeda68e1
name: VW_AR_INVOICE_TRANSACTION_WHALE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: FINANCIAL_DATA_MODEL
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a2d3271-78e2-4ddc-adfb-6ceec700c03c
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Payment ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b696b956-c17c-4bd5-923d-a6456a5cd3d0
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b14636f-2669-4542-9190-2daf65a33f2b
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Invoice ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9525d4c-b31b-49ef-9e66-ae9fcb652987
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b8e6454-4cfe-4aa1-a3ae-4d8924cc5419
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Site_Source
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a72f2b13-69e8-434e-8eb1-b89c81b4e2bc
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d650dedc-5beb-409b-b30a-df367a09ef70
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Source_Customer
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a682600-aa13-4ee5-abef-4f831ddadcb7
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a8fd9c3-6611-4238-a037-b291b771a1b8
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Source_Customer_Site
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fc88f2b-2cae-4438-a365-35438b67f174
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0a95ea-efee-4658-933e-b13e2008eb94
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Invoice Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbaa652b-6961-4027-bbb6-d8b13e51ab38
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccd6945c-e960-4598-8858-d1621af9def5
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Transaction Type
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36f6e991-2705-48e1-ae84-7906afa9bd1f
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49489234-9eb7-43af-937d-8e3797e2834a
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Transaction Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd0bc432-2b0c-4711-95e6-83d4f82d0e12
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cc9165f-a73c-4860-8d80-de976c3559b1
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Invoice Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67816917-6410-4205-9a64-b51e93f0c24e
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0863477-40e1-4ecd-b9dc-64dd3c2d33a9
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Due Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2ffb9b8-ca2a-4b1a-8147-b94faf0d23f4
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c57216d-aeca-4711-8eb9-aa6dd7729105
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        hashDetails: null
        name: Transaction Amount
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77c13bdd-ed6b-439c-9498-fa3498b6cc41
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 042ec411-d326-47f3-90b3-6fef7c10bf82
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        hashDetails: null
        name: Invoice Amount
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8604e516-c71f-4620-beae-098ec089feaf
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77252fee-e26e-4282-b119-6c7e692ed0ea
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(1,0)
        description: ""
        hashDetails: null
        name: Balance
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4e11233-b778-4737-bf82-5c89f884a23a
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e7352d-34df-488c-8a1a-0120b54ee4fe
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Record Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e2aa090-c81d-46e1-b5a7-91e9a304949f
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f543be54-e607-4741-9c25-06bce5f6f3ca
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: GL Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bc463ac-0f65-4b57-9856-582095bdd46f
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53cae2af-2479-4277-9987-15c6ded455c3
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Group ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e1841da-b60f-45ae-b530-6d8d24d27e18
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3bbbfd4-d08e-4e45-a777-d5594a6abb05
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(9,0)
        description: ""
        hashDetails: null
        name: dso_from_due
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd007924-f676-4341-9555-fd0a456af757
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de0e5dd4-b0cb-4b14-9f8a-229f52ba2322
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(9,0)
        description: ""
        hashDetails: null
        name: dso_from_invoice
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38ff83df-1a4d-42b8-8c0b-cb70f8e86c68
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 623c452f-54af-417d-b54e-d987ce7a0e63
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: Source
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c2e7344-6a22-4023-b607-e8398daa484e
                stepCounter: 4bd101c9-aecb-4198-8976-b5932e44ae7d
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0c9b3191-2014-4fad-9e1c-e1c6a2be0bec
          stepCounter: 2a079e46-0222-4f53-be62-f75daeda68e1
        config: {}
        dataType: NUMBER(18,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Outstanding Balance
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "VW_AR_INVOICE_TRANSACTION_2"."Transaction Type" = 'Invoice' THEN SUM("VW_AR_INVOICE_TRANSACTION_2"."Transaction Amount") OVER (PARTITION BY "VW_AR_INVOICE_TRANSACTION_2"."Invoice Number","Source") ELSE 0 END
        systemColumnType: None
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: FINANCIAL_DATA_MODEL
            nodeName: VW_AR_INVOICE_TRANSACTION_2
        join:
          joinCondition: FROM {{ ref('FINANCIAL_DATA_MODEL', 'VW_AR_INVOICE_TRANSACTION_2') }} "VW_AR_INVOICE_TRANSACTION_2"
        name: VW_AR_INVOICE_TRANSACTION_WHALE
        noLinkRefs: []
  name: VW_AR_INVOICE_TRANSACTION_WHALE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
