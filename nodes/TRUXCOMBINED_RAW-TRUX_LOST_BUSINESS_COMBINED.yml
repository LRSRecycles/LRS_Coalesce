fileVersion: 1
id: c3055e38-9745-451a-8b7f-7f753e196cbf
name: TRUX_LOST_BUSINESS_COMBINED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TRUXCOMBINED_RAW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cc1bec6-0f06-41fd-93ae-1bed2570f172
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: CM03_LOST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c273ed6f-0d7f-4d69-b637-1a3119b3100f
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d72b15af-ee4b-4cc0-a60c-0d71a7fee957
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CM05_SERV
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56d5f391-3d5b-496c-a6ee-b1af57f45c40
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dbfce73-cc8b-4074-8aab-f070e81fc121
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CM05_SDTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a1b168c-5e53-4dc7-a941-8e5417320267
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caddef5c-e8ac-426e-b99b-bd7a75935b3f
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CM05_EDTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40d74274-6794-48b9-8e0f-1a829dd6673c
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7028c8-13a1-4824-ab76-66fed2033899
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: CM05_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9dd769-aecd-46d5-a0d1-8bd2c3e5cbac
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f9d768-1301-4e7f-a33f-6d4f69215c14
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        name: CM05_MAXL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b3b1d57-168b-444f-b32e-d8417bc3fa6c
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f51c980b-6a0b-4409-b726-a865688a460e
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: CM05_ECOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 654c2bf6-a45f-435c-90f3-ca2c1b3f3f7c
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c178792e-c067-422e-9e1c-2b5dffc54861
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        description: ""
        name: CM05_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0f06b49-6396-4738-88b0-a62b67e09133
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeff727e-c616-4513-9fb0-ac00d5effe88
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: _FIVETRAN_SYNCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 413e1982-bafd-4f2b-b6bd-b1bd9bc4ba3b
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7fd11ce-f984-4ba7-be09-48a1a2f67090
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: BOOLEAN
        description: ""
        name: _FIVETRAN_DELETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39f3840d-fa70-4eff-8268-d23a7e5381ed
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34daa041-7daf-4c37-ab72-fb9f0137f9ed
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8acaf8af-3f75-44dc-858a-ef7abd091efe
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6d4cb4f0-453e-4564-8830-5b5ae8621289
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_CUST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4f0ee58-acb8-4fac-aecb-08df89feda55
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d04242af-f008-4bce-94f1-6e4f7d3e2c8f
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a89ab31-7625-4b35-a03c-d5dac82ec0de
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9db0d37a-a06f-4115-bb08-02b52be3db97
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_ADD1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ed153fe-140a-46cd-93f6-23b20903fa8f
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ed2a2240-ffbd-40c9-bb48-1788bc713d19
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd20db09-c2da-4727-944b-b0c3f2ba7b8a
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7e34627b-c948-42c4-8911-fdf7c5a4b3a2
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_CUSTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a05172f0-4e08-49b5-acfa-3ea4ca4f0dc6
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 28e81b66-ccf1-48e7-a6d5-da61a6f8f329
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_CDTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fecba0cc-674a-4762-b7c5-074b167152c2
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b2854ffe-d2f4-4525-becc-b617d8a11c43
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM03_SREP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9adfcf72-08fd-45ca-9732-e355649687b4
                stepCounter: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 35448f85-9d07-43c9-8f84-545d9cde656f
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD07_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CUSTCD07\".\"CD07_DESC\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 87ac3bfe-9f7f-42b0-a7eb-93579887cc54
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD03_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e99d9bcb-a280-43c1-be6d-b11489821019
                stepCounter: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 392b7d24-ad72-4284-a36c-c4a5a0e8b515
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM19_ACTV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CM19\".\"CM19_ACTV\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d7f0cd65-e8f8-4d1c-b368-08ca5b7b0914
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM19_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CM19\".\"CM19_UNIT\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 930b8687-4876-4610-8221-23a8344ba736
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(18,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Rate
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CURRENT_RATE\".\"CM19_RATE\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3f2b95bd-feb6-425d-811c-65847dc9e8da
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(18,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"SM01\".\"SM01_AMNT\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f11bf3cf-d485-4ffe-b91a-80127c656603
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(18,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVDISP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"LM02\".\"LM02_BAMT\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8e789b51-7289-40d9-bfc2-27eb4411efba
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD05_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e46ace0d-bead-46f8-96b6-d1cbb6c05ecd
                stepCounter: 8d5ae05b-da13-442c-8723-1ccdf0cb0eee
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a9c2a8c8-44e7-40b4-a38e-77d374e452a6
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Service_Type_Included
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cd03795-44e2-40b3-8307-a3f2e42f3056
                stepCounter: 032285e8-04c7-4507-ad3c-3192527dc47a
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7bee7827-501e-4442-b8fb-c291cd87dd8c
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD29_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f42c34e6-b3f6-4c62-a016-125b3f2b56ff
                stepCounter: 893f4c8e-1047-48f2-960d-dc4b4588a0e7
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e75925d9-1883-4a66-82a7-7fcfaa8c423f
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD11_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4de06533-a7c4-4c8d-8b21-67dc33ea6e83
                stepCounter: 3131b480-711a-434f-be4a-e6e3315d3c0a
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 642bf8dc-f79e-4bb4-83c9-439b8d88e941
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM04_SITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112edb7e-c114-4829-bb58-6e8264e56247
                stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ccaad11f-e5bf-43e1-923b-8c635ef0dfb2
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM04_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71f2b13a-b8ca-41f4-88e2-d0e2bacb512a
                stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a3eccd23-6639-4b08-bc21-d17145300bfe
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CM04_SREP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce78dbb3-a828-465f-8145-916c6a7cb577
                stepCounter: f47180be-fdce-4312-84ff-04027f8092c0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3a466de5-21e8-4796-ad8e-cbfad3bc2b3a
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: CD07_NAME2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"SITECD07\".\"CD07_DESC\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 68a15d67-ba78-443c-844f-e26ee72cf2b6
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SOURCE-CUST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CM05_COMBINED\".\"SOURCE\" || '-' || \"CM05_COMBINED\".\"CM05_CUST\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0c82c24f-3c41-4c7d-92c3-8178f860b061
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SOURCE-CUST-SITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CM05_COMBINED\".\"SOURCE\" || '-' || \"CM05_COMBINED\".\"CM05_CUST\" || '-' || \"CM05_COMBINED\".\"CM05_SITE\" "
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 25c51833-8727-478d-9c5f-ea7edd24d2d6
          stepCounter: c3055e38-9745-451a-8b7f-7f753e196cbf
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SOURCE-CUST-SITE-SERV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"CM05_COMBINED\".\"SOURCE\" || '-' || \"CM05_COMBINED\".\"CM05_CUST\" || '-' || \"CM05_COMBINED\".\"CM05_SITE\" || '-' || \"CM05_COMBINED\".\"CM05_SERV\""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CD03_COMBINED: 438b5c12-3ccb-4c0d-bce9-4a236319d37a
          CD05_COMBINED: 8d5ae05b-da13-442c-8723-1ccdf0cb0eee
          CD11_COMBINED: 3131b480-711a-434f-be4a-e6e3315d3c0a
          CD29_COMBINED: 893f4c8e-1047-48f2-960d-dc4b4588a0e7
          CM03_COMBINED: 2cc42f8b-439d-4d56-8885-e426b4ffc34c
          CM04_COMBINED: f47180be-fdce-4312-84ff-04027f8092c0
          CM05_COMBINED: 032285e8-04c7-4507-ad3c-3192527dc47a
          CM19: 7c8d23d5-3a31-4e02-b8d0-ea55002d8ef8
          CURRENT_RATE: c3f97a91-b31a-48aa-8219-f387d749b428
          CUSTCD07: bd4674f7-935e-485f-8433-a9a843dde723
          LM02: fd757e44-fc0c-44f0-9ad4-485bb3e9a3b1
          SITECD07: bd4674f7-935e-485f-8433-a9a843dde723
          SM01: 53a8a929-a4cf-42ec-86cd-8b7a17fbb62f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TRUXCOMBINED_RAW
            nodeName: CD03_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CD05_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CD07_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CD11_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CD29_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM03_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM04_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM05_COMBINED
          - locationName: TRUXCOMBINED_RAW
            nodeName: CM19_INNER_JOIN_LOST_BUSINESS
          - locationName: TRUXCOMBINED_RAW
            nodeName: GET_CURRENT_RATE
          - locationName: TRUXCOMBINED_RAW
            nodeName: LM02_INNER_JOIN_LOST_BUSINESS
          - locationName: TRUXCOMBINED_RAW
            nodeName: SM01_INNER_JOIN_LOST_BUSINESS
        join:
          joinCondition: |-
            FROM {{ ref('TRUXCOMBINED_RAW', 'CM05_COMBINED') }} "CM05_COMBINED"
            INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM04_COMBINED') }} "CM04_COMBINED"
                ON "CM04_CUST" = "CM05_CUST" 
               AND "CM04_SITE" = "CM05_SITE"
               AND "CM05_COMBINED"."SOURCE" = "CM04_COMBINED"."SOURCE"
            INNER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM03_COMBINED') }} "CM03_COMBINED" 
                ON "CM03_CUST" = "CM05_CUST"
               AND "CM03_COMBINED"."SOURCE" = "CM05_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD03_COMBINED') }} "CD03_COMBINED" 
                ON "CD03_CODE" = "CM05_ECOD"
               AND "CD03_COMBINED"."SOURCE" = "CM05_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD29_COMBINED') }} "CD29_COMBINED"
                ON "CD29_CODE" = "CM05_LOST"
               AND "CD29_COMBINED"."SOURCE" = "CM05_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD11_COMBINED') }} "CD11_COMBINED" 
                ON "CD11_CODE" = "CM03_CUSTTYPE"
               AND "CD11_COMBINED"."SOURCE" = "CM03_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD05_COMBINED') }} "CD05_COMBINED"
                ON "CD05_CODE" = "CM05_TYPE"
               AND "CD05_COMBINED"."SOURCE" = "CM05_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD07_COMBINED') }} CUSTCD07 
                ON CUSTCD07.CD07_CODE = "CM03_SREP"
               AND "CUSTCD07"."SOURCE" = "CM03_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CD07_COMBINED') }} SITECD07 
                ON "SITECD07"."CD07_CODE" = "CM04_SREP"
               AND "SITECD07"."SOURCE" = "CM04_COMBINED"."SOURCE"
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'CM19_INNER_JOIN_LOST_BUSINESS') }} CM19
            	ON "CM19"."CM19_CUST" = "CM03_CUST" 
               AND "CM19"."CM19_SITE" = "CM04_SITE" 
               AND "CM19"."CM19_SERV" = "CM05_SERV"
               AND "CM19"."SOURCE" = "CM05_COMBINED"."SOURCE"       
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'LM02_INNER_JOIN_LOST_BUSINESS') }} LM02 
            	ON "LM02"."LM02_CUST" = "CM03_CUST" 
               AND "LM02"."LM02_SITE" = "CM04_SITE" 
               AND "LM02"."LM02_SERV" = "CM05_SERV"
               AND "LM02"."SOURCE" = "CM05_COMBINED"."SOURCE" 
              LEFT OUTER JOIN {{ ref('TRUXCOMBINED_RAW', 'SM01_INNER_JOIN_LOST_BUSINESS') }} SM01 
            	ON "SM01"."SM01_CUST" = "CM03_CUST" 
               AND "SM01"."SM01_SITE" = "CM04_SITE" 
               AND "SM01"."SM01_SERV" = "CM05_SERV"
               AND "SM01"."SOURCE" = "CM05_COMBINED"."SOURCE" 
              LEFT JOIN {{ ref('TRUXCOMBINED_RAW', 'GET_CURRENT_RATE') }} CURRENT_RATE
              ON "CM03_CUST" = "CURRENT_RATE"."CM19_CUST"
               AND "CM04_SITE" = "CURRENT_RATE"."CM19_SITE"
               AND "CM05_SERV" = "CURRENT_RATE"."CM19_SERV"
               AND "CM19"."CM19_ACTV" = "CURRENT_RATE"."CM19_ACTV"
               AND "CM05_COMBINED"."SOURCE" = "CURRENT_RATE"."SOURCE"
            
            WHERE "CM05_TYPE" IS NOT NULL
        name: TRUX_LOST_BUSINESS_COMBINED
        noLinkRefs: []
  name: TRUX_LOST_BUSINESS_COMBINED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
