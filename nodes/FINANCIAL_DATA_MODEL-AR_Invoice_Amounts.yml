steps:
  AR_Invoice_Amounts-6cbdcc75-9616-48ec-95e9-b79240d9b295:
    operation:
      config:
        postSQL: ""
        preSQL: ""
        testsEnabled: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: true
      locationName: FINANCIAL_DATA_MODEL
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 3c5e210c-c1a6-409a-a4a9-74f4a104ccc4
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Unique ID
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 211aa298-7f67-4322-9609-72bcc084a9d4
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: 111bad04-bc85-4134-87f5-94b50b73b88f
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: f799cde5-2702-492d-be83-b43e55baefd9
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Customer Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 64cf6d67-23b9-4857-bcf4-9e015676ec29
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: 5956ecf5-eac0-452d-bff8-c0c0a4726079
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: 5379cca1-7f0b-4e64-bbd8-c71aec741730
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Site Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 25f8fce1-ad43-4914-990f-a7c850570b9f
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: 51906245-5785-4183-b5b3-7c2efb467e0a
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: 581c44d4-daea-4fc9-a443-158eec519821
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR(13)
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: Invoice Number
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1f356938-0bc2-446d-8f1d-32b45a428e8d
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: 4c17e5b5-2455-491a-9545-2041740d9c06
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: e6f56b2b-1b54-43c6-98e4-586d31c8653d
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Invoice Date
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 12f3a20e-0e2b-4cad-b889-04b355254a1f
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: d38fccc5-a289-448d-9c0f-9adcfb1c4cd1
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: 5a271921-8496-4417-9c96-77c87aa5e397
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: NUMBER(18,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: Amount
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2cf8791b-03b2-4140-873f-97915236e997
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences:
                  - columnCounter: 7b76ad9f-a097-441f-a77e-720fc86e9fd4
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
          - columnReference:
              columnCounter: e4337c49-1766-460d-ad3f-94fbcba823cc
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            hashColumns: []
            hashDetails: null
            isBusinessKey: true
            name: SOURCE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 98b82faf-041c-44af-9aa2-4c256b725e39
                    stepCounter: af7d9a71-a790-437a-a79e-4fb3a178059a
                transform: ""
              - columnReferences: []
                transform: "'TOWER'"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c6879ef4-beac-426d-aa95-ec4058ddb673
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            isBusinessKey: true
            keyColumnType: None
            name: Customer_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED_STREAM\".\"DM01_CUST\"||\"DM01_COMBINED_STREAM\".\"SOURCE\""
              - columnReferences: []
                transform: "\"INVOICE_COMBINED\".\"Customer Number\"||'TOWER'"
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 9201fbce-c10b-4c18-9853-a9b4bba17628
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Customer_Site_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED_STREAM\".\"DM01_CUST\"||\"DM01_COMBINED_STREAM\".\"DM01_SITE\"||\"DM01_COMBINED_STREAM\".\"SOURCE\""
              - columnReferences: []
                transform: "\"INVOICE_COMBINED\".\"Site Number\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bbaeae2b-c40f-4a97-be3d-688aaaf24606
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: varchar
            defaultValue: ""
            description: ""
            isBusinessKey: true
            keyColumnType: None
            name: ID_Source
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: "\"DM01_COMBINED_STREAM\".\"DM01_ID\"||\"DM01_COMBINED_STREAM\".\"SOURCE\""
              - columnReferences: []
                transform: "\"INVOICE_COMBINED\".\"Invoice Number\""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6c02cb13-aac2-4697-8a30-eee9804bcb6b
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: DATETIME
            defaultValue: ""
            description: Eventually will be Terms + invoice date where applicable in TRUX, correct in Tower
            keyColumnType: None
            name: Due Date
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: CASE WHEN "CUSTOMER_MASTER"."Initial Term" is null then DM01_COMBINED_STREAM."DM01_DATE" else dateadd(day,CUSTOMER_MASTER."Initial Term",DM01_COMBINED_STREAM."DM01_DATE") end
              - columnReferences:
                  - columnCounter: c42361b3-22d2-49ed-a95c-d81598854894
                    stepCounter: 106c0503-bc82-4d45-940b-e5c0faa31a50
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bdbe539b-8400-4583-9c2a-3e4896958c2d
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: VARCHAR
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Customer Term
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d8fc5bf7-df15-42fe-8363-94cbe665d3e8
                    stepCounter: a83e2043-c50d-4bf2-8f19-a0858a24d969
                transform: ""
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 02dd5865-c418-4848-81e4-df6f94e2bae7
              stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
            config: {}
            dataType: NUMBER
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: Active Sort
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: ROW_NUMBER() OVER(PARTITION BY "DM01_COMBINED_STREAM"."METADATA$ROW_ID" ORDER BY "DM01_COMBINED_STREAM"."_FIVETRAN_SYNCED")
              - columnReferences: []
                transform: ""
            systemColumnType: None
            transform: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              CUSTOMER_MASTER: a83e2043-c50d-4bf2-8f19-a0858a24d969
              DM01_COMBINED_STREAM: af7d9a71-a790-437a-a79e-4fb3a178059a
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: MASTER_DATA_CLEAN
                nodeName: CUSTOMER_MASTER
              - locationName: TRUXCOMBINED_RAW
                nodeName: DM01_COMBINED_STREAM
            join:
              joinCondition: |-
                FROM {{ ref('TRUXCOMBINED_RAW', 'DM01_COMBINED_STREAM') }} "DM01_COMBINED_STREAM"
                LEFT JOIN {{ ref('MASTER_DATA_CLEAN', 'CUSTOMER_MASTER') }} "CUSTOMER_MASTER"
                ON "DM01_COMBINED_STREAM"."DM01_CUST" = "CUSTOMER_MASTER"."Customer Number"
                AND "DM01_COMBINED_STREAM"."SOURCE" = "CUSTOMER_MASTER"."SOURCE_NEW"
            name: DM01_COMBINED_TRUX
            noLinkRefs: []
          - aliases:
              INVOICE_COMBINED: 106c0503-bc82-4d45-940b-e5c0faa31a50
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TOWER_COMBINED
                nodeName: INVOICE_COMBINED
            join:
              joinCondition: |-
                FROM {{ ref('TOWER_COMBINED', 'INVOICE_COMBINED') }} "INVOICE_COMBINED"
                where "SYSTEM_CURRENT_FLAG" = 'Y' and "INVOICE_COMBINED"."Amount"<>0
            name: Invoice_Combined_Tower
            noLinkRefs: []
      name: AR_Invoice_Amounts
      overrideSQL: false
      schema: ""
      sqlType: persistentStage
      type: sql
    stepCounter: 6cbdcc75-9616-48ec-95e9-b79240d9b295
