fileVersion: 1
id: d3ad60e4-7918-4136-9751-531e378c67c3
name: STG_DM05_COMBINED_FILTERED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TRUXCOMBINED_RAW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0859d9e-d5e1-4003-a011-e0aa46472276
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: Record UID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 667eb221-f7c6-4fe2-8805-6ef25bd78038
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bd982c-3650-4740-b5f9-97ef63808057
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Charge Type
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1911f982-69f2-4b34-b851-66b630f88930
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b77de08-e91f-4379-8f4c-c2eb8530260e
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Sort
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ed0a09b-312a-429a-86d3-29d549ca33fb
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d53ecfe1-73ad-4639-9877-6f1b3bc9fb10
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: Invoice UID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddb60d94-5c4d-4300-90f1-e6fb34d624ce
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 695f2fda-4444-474d-ab8a-bf22dd5876c3
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(26)
        description: ""
        name: Invoice Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4028313f-755a-42b5-825e-fc5958e01200
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c8e11b44-976e-424d-80c8-03850f00f3f3
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Billing Customer Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1adb5048-393a-4b15-8914-e90b30e26507
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 465bb492-380f-4993-8ce3-05bf2a886bac
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: Billing Site Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab71286f-7e4a-421f-a73a-b7e901cf4726
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76483a01-bf01-4aff-bf89-7593e8673df4
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Service Site Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb3a634f-1b82-4629-af22-9c81ce74d44d
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82ff2db9-383a-4828-87bc-f0eafe43eff1
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Service Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee87234-7393-4f43-8bae-eeb74f555923
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8f938b7-0082-4eda-9307-a350325ef890
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Transaction Date
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42aebcb8-8502-4b52-a35d-b3eea85c8f27
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b069ad-b8ae-4755-998d-edf41a63ed75
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        hashDetails: null
        name: Amount
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3c05390-ed32-4856-92ba-b0a8f9d9668d
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cb02ad9-f8cb-4744-8726-a9d0227ff6a0
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        hashDetails: null
        name: Quantity
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde0c3db-a578-4032-89f9-938c6e0c66f3
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5a70715-dcc7-4572-a0cb-6513160974f9
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Activity Code
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1559a9e8-541a-42f4-ad01-b891fd41a2eb
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e75ac2fd-8ce4-4cf7-86c0-accbb64ee087
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Activity Description
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2041f1cc-98b5-45b7-92e6-ed75253dcf64
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9821221-e52d-473d-853b-33bab6497a27
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: Route Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 020046b2-a4b9-4a87-a6d8-e0993421c489
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a490555-81b8-4b2a-ab9d-ff173555051b
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(18,2)
        description: ""
        hashDetails: null
        name: Sequence Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2de04f3a-ad73-453c-85d2-fe31d19943cd
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 173f56a9-e0ce-4638-85ab-efdc487a3509
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Rate ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b44cd26-12a5-493b-9789-125161354669
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f033cb2-bd69-407e-b25c-2655936e11de
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Bill From Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff7a1ca-f9a0-42e8-9ccc-cf851d12bd7e
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea2ca569-f328-4a15-b025-7e3d3aebc12f
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Bill To Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5614d1d-00c0-4a3e-a9f0-dd4dc8474b24
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e01940f8-6732-4e68-970e-f073e1641f9e
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Tax Type
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d42b9783-a745-4c79-9d2f-f4bcd57910ba
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6af05c7-aca5-4605-93e7-40ce486527d4
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NVARCHAR
        description: ""
        hashDetails: null
        name: Facility
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7457123-f5ee-4197-8349-537bbcf8686e
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f32f51ff-81e9-40cf-a393-c166ac0f504a
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Ticket Number
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 552e62fd-912f-4b46-a409-b791b086fff3
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcea4e3b-8761-4cbb-811d-3b7d0098f687
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Disposal Unique Identifier
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbe3c64d-2b5e-49cc-9b66-bd8e90672bed
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d763616-9b02-4b61-ac62-c8623edc3aee
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Billing Unit of Measure
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5f46eb-fa41-4804-8cd6-5c87efd15f92
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20132a45-875d-417e-80ca-bae19f50c413
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: Link to Disposal Ticket
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38bb6358-b2fb-4d88-8abd-19cc500d2351
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03a8736c-ceff-43b8-a18c-afe8331355cf
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NVARCHAR
        description: ""
        hashDetails: null
        name: Reference
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d141e08f-9222-48df-8823-116b20d2ac5e
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48229867-738a-4597-bd44-01454ed2bac1
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: Period ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 181e288f-3e0a-4619-9503-214fa8ef8308
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a20445c-fd20-434e-a1dc-2792591786f5
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: User
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f38d7a3f-cf9d-4e14-83d7-5babb0a42c1f
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 350a2ce0-6c3b-4514-940e-c1ff4edc4dea
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: Record Type
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10c05046-1ecb-4651-a943-a0edbb59af21
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a39aa1a-1bd8-4722-844a-1eab0da559e4
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        hashDetails: null
        name: Record Date
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ed54b88-472e-4dad-a874-023f6989ee42
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 091fe9ab-d8b6-4e1a-8f16-68972b8d0cce
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(2)
        description: ""
        hashDetails: null
        name: Adjustment Reason Code
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a1be88c-2286-4143-8e23-aefd2c5ad11c
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f930c615-5b6c-474a-8366-bedd4b9e89ed
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: Adjustment Reason
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aec39263-150b-4d66-a4f6-99cd0d1c7edb
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 745d3cea-86b7-4c89-b573-839ca8052d5e
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: Adjustment Note ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53f7137d-bb14-44af-a705-d931cb46b131
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbe7a35f-ab6c-46be-b099-415819702cd1
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails: null
        name: Source
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2e81ae7-4040-46b6-9edd-1d83089c9f97
                stepCounter: 1cac55f3-17d5-4de8-9981-4296288a10ad
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 066b7c07-2198-4d95-bfe7-86cb0bb5a48f
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_DM05_COMBINED\".\"SOURCE\"||'-'||\"STG_DM05_COMBINED\".\"DM01_CUST\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd94b61-ace0-4b37-a8a8-db20eae1bfed
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Billing_Source_Customer_Site
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_DM05_COMBINED\".\"SOURCE\"||'-'||\"STG_DM05_COMBINED\".\"DM01_CUST\"||'-'||\"STG_DM05_COMBINED\".\"DM01_SITE\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: eb09f2fe-4b41-4139-9173-2a1f0b0758a6
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Customer_Site_Service
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_DM05_COMBINED\".\"SOURCE\"||'-'||\"STG_DM05_COMBINED\".\"DM01_CUST\"||'-'||\"STG_DM05_COMBINED\".\"DM05_SSIT\"||'-'||\"STG_DM05_COMBINED\".\"DM05_SERV\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ea372057-6c48-40db-a1dd-b056d5b7eb65
          stepCounter: d3ad60e4-7918-4136-9751-531e378c67c3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: Source_Invoice_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_DM05_COMBINED\".\"SOURCE\"||'-'||\"STG_DM05_COMBINED\".\"DM05_LINK\""
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_DM05_COMBINED: 1cac55f3-17d5-4de8-9981-4296288a10ad
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TRUXCOMBINED_RAW
            nodeName: STG_DM05_COMBINED
        join:
          joinCondition: |2-
             FROM {{ ref('TRUXCOMBINED_RAW', 'STG_DM05_COMBINED') }} "STG_DM05_COMBINED"
            WHERE "STG_DM05_COMBINED"."DM05_TDTE" >= DATEADD(DAY, -730, CURRENT_DATE())
        name: STG_DM05_COMBINED_FILTERED
        noLinkRefs: []
  name: STG_DM05_COMBINED_FILTERED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
